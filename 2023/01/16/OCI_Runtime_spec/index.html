<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 6.3.0">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://gcore.jsdelivr.net'>
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>OCI Runtime spec 运行时规范 - 知识库</title>

  
    <meta name="description" content="一 概述参考  **OCI 运行时规范目的是为了标准化一个容器的配置、执行环境、生命周期管理**。容器的配置文件由名为 config.json 文件内指定，配置文件内容提供所支持系统平台和创建一个容器所需的详细信息。执行环境是为了确保在容器内运行的应用程序与运行时具备的一致的环境，以及为容器的生命周期管理定义的了标准的公共操作。 容器原则 参考 OCI 定义软件交付的最小单元称之为”标准容器”，标">
<meta property="og:type" content="article">
<meta property="og:title" content="OCI Runtime spec 运行时规范">
<meta property="og:url" content="http://example.com/2023/01/16/OCI_Runtime_spec/index.html">
<meta property="og:site_name" content="知识库">
<meta property="og:description" content="一 概述参考  **OCI 运行时规范目的是为了标准化一个容器的配置、执行环境、生命周期管理**。容器的配置文件由名为 config.json 文件内指定，配置文件内容提供所支持系统平台和创建一个容器所需的详细信息。执行环境是为了确保在容器内运行的应用程序与运行时具备的一致的环境，以及为容器的生命周期管理定义的了标准的公共操作。 容器原则 参考 OCI 定义软件交付的最小单元称之为”标准容器”，标">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-01-16T03:39:37.704Z">
<meta property="article:modified_time" content="2023-01-16T03:39:37.704Z">
<meta property="article:author" content="YuChang Yang">
<meta property="article:tag" content="docker">
<meta property="article:tag" content="containerd">
<meta name="twitter:card" content="summary_large_image">
  
  

  <!-- feed -->
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  
    <link rel="shortcut icon" href="/assets/knowledge.png">
  

  

  


  
</head>

<body>
  

<div class="l_cover post"><div class="cover"><div class="lazy img bg" data-bg="/assets/wiki/photos/newyear04.jpg"></div></div></div>


  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    

  

<header class="header"><div class="logo-wrap"><a class="avatar" href="/"><div class="bg" style="opacity:0;background-image:url(https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/avatar/round/rainbow64@3x.webp);"></div><img no-lazy class="avatar" src="/assets/logo.svg" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.4/image/2659360.svg';"></a><a class="title" href="/"><div class="main" ff="title">知识库</div><div class="sub normal cap">建立团队内部知识分享</div><div class="sub hover cap" style="opacity:0"> 统一团队问题管理机制</div></a></div>

<nav class="menu dis-select"><a class="nav-item active" href="/">技术分享</a><a class="nav-item" href="/wiki/">问题汇总</a></nav>
</header>


<div class="widgets">
<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/blog/" placeholder="文章搜索"><svg t="1670596976048" class="icon search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2676" width="200" height="200"><path d="M938.2 832.6L723.8 618.1c-2.5-2.5-5.3-4.4-7.9-6.4 36.2-55.6 57.3-121.8 57.3-193.1C773.3 222.8 614.6 64 418.7 64S64 222.8 64 418.6c0 195.9 158.8 354.6 354.6 354.6 71.3 0 137.5-21.2 193.2-57.4 2 2.7 3.9 5.4 6.3 7.8L832.5 938c14.6 14.6 33.7 21.9 52.8 21.9 19.1 0 38.2-7.3 52.8-21.8 29.2-29.1 29.2-76.4 0.1-105.5M418.7 661.3C284.9 661.3 176 552.4 176 418.6 176 284.9 284.9 176 418.7 176c133.8 0 242.6 108.9 242.6 242.7 0 133.7-108.9 242.6-242.6 242.6" p-id="2677"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget>


<widget class="widget-wrapper toc single" id="data-toc"><div class="widget-header cap dis-select"><span class="name">OCI Runtime spec 运行时规范</span></div><div class="widget-body fs14"><div class="doc-tree active"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E6%A6%82%E8%BF%B0"><span class="toc-text">一 概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%AE%B9%E5%99%A8%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%8C%85"><span class="toc-text">二 容器文件系统包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E8%BF%90%E8%A1%8C%E6%97%B6%E4%B8%8E%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">三 运行时与生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-text">容器作用域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#State-%E5%AE%B9%E5%99%A8%E7%8A%B6%E6%80%81"><span class="toc-text">State 容器状态</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LifeCycle-%E5%AE%B9%E5%99%A8%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">LifeCycle 容器的生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Errors-%E6%8A%A5%E9%94%99"><span class="toc-text">Errors 报错</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Operations-%E6%93%8D%E4%BD%9C%E5%AE%B9%E5%99%A8"><span class="toc-text">Operations 操作容器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hook-%E5%AE%B9%E5%99%A8%E6%89%A7%E8%A1%8C%E5%8B%BE%E5%AD%90"><span class="toc-text">Hook 容器执行勾子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux-%E8%BF%90%E8%A1%8C%E6%97%B6"><span class="toc-text">Linux 运行时</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E9%85%8D%E7%BD%AE-Linux-spec"><span class="toc-text">四 配置( Linux spec )</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Specification-version"><span class="toc-text">Specification version</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Root-Configuration"><span class="toc-text">Root Configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mounts"><span class="toc-text">Mounts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Process-configuration"><span class="toc-text">Process configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#User"><span class="toc-text">User</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hostname"><span class="toc-text">Hostname</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Platform"><span class="toc-text">Platform</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Platform-specific-configuration"><span class="toc-text">Platform-specific configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Namespaces"><span class="toc-text">Namespaces</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#User-namespace-mappings"><span class="toc-text">User namespace mappings</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Devices"><span class="toc-text">Devices</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Control-groups"><span class="toc-text">Control groups</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Device-whitelist"><span class="toc-text">Device whitelist</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Disable-out-of-memory-killer"><span class="toc-text">Disable out-of-memory killer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-oom-score-adj"><span class="toc-text">Set oom_score_adj</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Memory"><span class="toc-text">Memory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CPU"><span class="toc-text">CPU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Block-IO-Controller"><span class="toc-text">Block IO Controller</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Huge-page-limits"><span class="toc-text">Huge page limits</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Network"><span class="toc-text">Network</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#PIDs"><span class="toc-text">PIDs</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Sysctl"><span class="toc-text">Sysctl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Seccomp"><span class="toc-text">Seccomp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rootfs-Mount-Propagation"><span class="toc-text">Rootfs Mount Propagation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Masked-Paths"><span class="toc-text">Masked Paths</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Readonly-Paths"><span class="toc-text">Readonly Paths</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Mount-Label"><span class="toc-text">Mount Label</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hooks"><span class="toc-text">Hooks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Annotations"><span class="toc-text">Annotations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Extensibility"><span class="toc-text">Extensibility</span></a></li></ol></li></ol></div></div></widget>




</div>
<footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/gotoolkits" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/github.svg" /></a><a class="social" href="https://mail.163.com" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/mail.svg" /></a><a class="social" href="https://www.jianshu.com/u/0611daf62bd3" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/datas.svg" /></a><a class="social" href="https://www.jianshu.com/u/0611daf62bd3" target="_blank" rel="external nofollow noopener noreferrer"><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/assets/jianshu.svg" /></a></div></footer>

    </aside>
    <div class='l_main'>
      

      


<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/">技术文档</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/docker%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">docker源码分析</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/docker%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/OCI/">OCI</a></div><div id="post-meta">发布于&nbsp;<time datetime="2023-01-16T03:39:37.704Z">2023-01-16</time></div></div>

<article class='md-text content post'>
<h1 class="article-title"><span>OCI Runtime spec 运行时规范</span></h1>
<h2 id="一-概述"><a href="#一-概述" class="headerlink" title="一 概述"></a>一 概述</h2><p><a target="_blank" rel="noopener" href="https://github.com/opencontainers/runtime-spec/blob/master/spec.md">参考</a></p>
<p> **OCI 运行时规范目的是为了标准化一个容器的<code>配置</code>、<code>执行环境</code>、<code>生命周期管理</code>**。容器的配置文件由名为 config.json 文件内指定，配置文件内容提供所支持系统平台和创建一个容器所需的详细信息。执行环境是为了确保在容器内运行的应用程序与运行时具备的一致的环境，以及为容器的生命周期管理定义的了标准的公共操作。</p>
<p><strong>容器原则</strong></p>
<p><a target="_blank" rel="noopener" href="https://github.com/opencontainers/runtime-spec/blob/master/principles.md">参考</a></p>
<p>OCI 定义软件交付的最小单元称之为”标准容器”，标准容器是为了按自描述性和可移值性的格式封装应用程序及其依赖的所有组件，实现任何遵从规范的运行时再无需额外依赖的运行，以及与底层机器设备和容器内部内容都无关。</p>
<p>标准容器的5个原则：</p>
<ul>
<li>标准操作</li>
<li>内容无关</li>
<li>基础设施无关</li>
<li>为自动化设计</li>
<li>工业级交付</li>
</ul>
<h2 id="二-容器文件系统包"><a href="#二-容器文件系统包" class="headerlink" title="二 容器文件系统包"></a>二 容器文件系统包</h2><p><a target="_blank" rel="noopener" href="https://github.com/opencontainers/runtime-spec/blob/master/bundle.md">参考</a></p>
<p>OCI Image 可通过镜像名称发现、下载、hash值来验证、签名受信以及解包成 OCI 运行时 Bundle。一个标准的容器 bundle 包含容器加载和运行所有所需的信息，其包含如下：</p>
<ol>
<li>config.json 容器配置数据文件，必须与文件系统同目录下，文件名必须为 config.json。后面<strong>配置</strong>部分有详细说明此 config 定义内容与详解。</li>
<li>root filesystem 容器 root 文件系统(启动的只读文件)，在 config.json 文件内有指定 root.path。</li>
</ol>
<h2 id="三-运行时与生命周期"><a href="#三-运行时与生命周期" class="headerlink" title="三 运行时与生命周期"></a>三 运行时与生命周期</h2><p><a target="_blank" rel="noopener" href="https://github.com/opencontainers/runtime-spec/blob/master/runtime.md">参考</a></p>
<h4 id="容器作用域"><a href="#容器作用域" class="headerlink" title="容器作用域"></a>容器作用域</h4><p>除了访问控制问题，使用运行时创建容器的实体必须能够针对同一容器使用本规范中定义的操作。其他实体使用相同或其他实例的运行时是否可以看到该容器超出本规范的范围。</p>
<h4 id="State-容器状态"><a href="#State-容器状态" class="headerlink" title="State 容器状态"></a>State 容器状态</h4><p>容器的状态至少 <strong>必须</strong> 包含以下的属性：</p>
<ul>
<li><strong>ociVersion</strong>:  <em>string</em> 创建容器时用到的规范的版本号</li>
<li><strong>id</strong>: <em>string</em> 容器 ID， <strong>必须</strong> 是本地唯一的，但不要求跨主机唯一。</li>
<li><strong>status</strong>: <em>string</em> 容器的运行时状态。可能是以下值中的一个:<ul>
<li><code>created</code> : 容器已经被创建，但是用户代码未被执行。</li>
<li><code>running</code> : 容器被创建，且用户代码正在运行。</li>
<li><code>stopped</code> : 容器被创建，用户代码执行完毕，但不在继续运行。</li>
</ul>
</li>
</ul>
<p>新的状态可以由运行时自定义，但是它们 <strong>必须</strong> 用来表示未在上面定义的新运行时状态。</p>
<ul>
<li><strong>pid</strong>: <em>int</em> 主机可见的容器进程 ID。</li>
<li><strong>bundlePath</strong>: <em>string</em> 容器 bundle 目录的绝对路径。提供给 consumers 查找容器的配置和 rootfs 。</li>
<li><strong>annotations</strong>: <em>map</em> 包含了容器相关的注解列表。如果没提供任何的注解，则 <strong>可能</strong> 不存在或是个空map。</li>
</ul>
<p>当使用JSON序列化时，其格式 <strong>必须</strong> 遵守以下样式：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ociVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;oci-container1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;running&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;pid&quot;</span><span class="punctuation">:</span> <span class="number">4422</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;bundlePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/containers/redis&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;annotations&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;myKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;myValue&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>有关检索容器的状态信息，请看<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#query-state">query state</a>。</p>
<h4 id="LifeCycle-容器的生命周期"><a href="#LifeCycle-容器的生命周期" class="headerlink" title="LifeCycle 容器的生命周期"></a>LifeCycle 容器的生命周期</h4><p>生命周期描述了从容器被创建到停止退出之间的事件的时间线。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#create"><code>create</code></a> 命令需要配合 bundle 文件地址和唯一 ID 调用。</li>
<li><strong>必须</strong> 通过 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.json</code></a> 中的配置创建容器的运行时环境，如果运行时无法创建环境， <strong>必须</strong> 报错。虽然 <strong>必须</strong> 创建 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.json</code></a> 中请求的资源，但用户代码不能在此时运行。此阶段后对 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.json</code></a> 的任何更改 <strong>一定不能</strong> 影响到容器。</li>
<li>容器所创建的附加操作基于运行时特征选择性的<strong>可能</strong>被执行，因此有些操作仅基于当前容器的状态才可能有效(如仅有效于运行态)。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#start"><code>start </code></a> 命令需要配合容器的唯一 ID 调用。运行时 <strong>必须</strong> 通过指定的<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#process-configuration"><code>进程</code></a>执行用户代码。</li>
<li>容器的进程停止， <strong>可能</strong> 是由于进程出错，退出，宕机或调用了运行时的 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#kill"><code>kill</code></a> 命令。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#delete"><code>delete </code></a>命令需要配合容器的唯一 ID 调用。 必须回滚在 create 阶段期间执行的步骤销毁容器。</li>
</ul>
<h4 id="Errors-报错"><a href="#Errors-报错" class="headerlink" title="Errors 报错"></a>Errors 报错</h4><p>（本规范列举的）操作报错的情况下， 本规范不强制要求具体实现（比如 runc ）如何&#x2F;是否返回或暴露错误给用户。除非另有说明，否则报错后 <strong>必须</strong> 重置环境的状态到操作没被执行过一样——除了像日志这种比较小的修改。</p>
<h4 id="Operations-操作容器"><a href="#Operations-操作容器" class="headerlink" title="Operations 操作容器"></a>Operations 操作容器</h4><p>除非底层的操作系统无法支持，否则兼容 OCI 的运行时 <strong>必须</strong> 支持下列的操作。这些操作不指定任何命令行 API ，并且这些参数是用于一般操作的入参。</p>
<p><strong>Query State</strong>  <em>状态查询</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">state &lt;container-id&gt;</span><br></pre></td></tr></table></figure>

<p>此操作在不提供容器 ID 时 <strong>必须</strong> 报错。尝试查询一个不存在的容器 <strong>必须</strong> 报错。此操作 <strong>必须</strong> 返回同<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#state"><code>状态</code></a>一节指定的容器的状态（信息）。</p>
<p><strong>Create</strong> <em>容器创建</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create &lt;container-id&gt; &lt;path-to-bundle&gt;</span><br></pre></td></tr></table></figure>

<p>此操作在不提供 bundle 文件的路径和容器 ID 时 <strong>必须</strong> 报错。如果提供了一个在 runtime（管理的）范围内不唯一，或者无效的 ID，其底层实现 <strong>必须</strong> 报错，且容易 <strong>一定不能</strong> 被创建。利用 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.json</code></a> 文件里的数据，此操作 <strong>必须</strong> 创建一个新的容器，这意味着该容器相关的资源 <strong>必须</strong> 被创建，但是，用户指定的代码在此阶段 <strong>一定不能</strong> 被执行。如果运行时不能依照如 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.md</code></a> 指定的容器，则 <strong>必须</strong> 报错，且新容器 <strong>一定不能</strong> 被创建。</p>
<p>成功完成此操作后，此容器的 <code>status </code>属性值 <strong>必须</strong> 是 <code>created</code>。</p>
<p>运行时在创建容器前（<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#lifecycle">步骤2</a>），<strong>可以</strong> 根据此规范一般或相对于当前系统的能力验证 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.json </code></a>。 运行时的调用者如果感兴趣 pre-create 校验，可以在此操作（create）前调用 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/implementations.md#testing--tools">bundle-validation tools</a> 。</p>
<p>成功执行完成此操作后，容器 <strong>必须</strong> 被创建好。</p>
<p>再此操作执行成功之后，任何针对<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md"><code>config.json</code></a>的修改都不会影响到（创建出来的）容器。</p>
<p><strong>Start</strong> <em>容器运行</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start &lt;container-id&gt;</span><br></pre></td></tr></table></figure>

<p>此操作在不提供容器ID时 <strong>必须</strong> 报错。尝试启动一个不存在的容器 <strong>必须</strong> 报错。尝试启动一个已经运行的容器 <strong>必须</strong> 没有任何效果，且 <strong>必须</strong> 报错。此操作 <strong>必须</strong> 由<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#process-configuration"><code>进程</code></a>运行用户代码。</p>
<p>成功执行完成此操作后，此容器的<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#state"><code>status</code></a>属性值 <strong>必须</strong> 是<code>running</code>。</p>
<p><strong>Kill</strong> <em>容器停止</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill &lt;container-id&gt; &lt;signal&gt;</span><br></pre></td></tr></table></figure>

<p>此操作在不提供容器ID时 <strong>必须</strong> 报错。尝试向一个非运行的容器发送信号量， <strong>必须</strong> 没有任何效果，并且 <strong>必须</strong> 报错。此操作 <strong>必须</strong> 向容器内的进程发送指定的信号量。</p>
<p>当容器内的进程停止了，不管是<code>kill</code>操作还是其他原因导致的，这个容器的<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#state"><code>status</code></a>属性值 <strong>必须</strong> 是<code>stopped</code></p>
<p><strong>Delete</strong> <em>删除容器</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete &lt;container-id&gt;</span><br></pre></td></tr></table></figure>

<p>此操作在不提供容器 ID 时 <strong>必须</strong> 报错。尝试删除一个不存在容器 <strong>必须</strong> 报错。尝试删除一个其进程仍然运行的容器 <strong>必须</strong> 报错。删除容器 <strong>必须</strong> 释放其<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/runtime.md#create"><code>创建</code></a>时申请的资源。注意，非容器创建的， 但是相关的资源， <strong>一定不能</strong> 被删除。一旦容器被删除，它的 ID <strong>可能</strong> 分配给后续的容器使用。</p>
<h4 id="Hook-容器执行勾子"><a href="#Hook-容器执行勾子" class="headerlink" title="Hook 容器执行勾子"></a>Hook 容器执行勾子</h4><p>在本规范中提到的许多操作，都允许在每个操作之前或之后采取附加动作的“钩子”。更多“钩子”的信息请参考<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#hooks">运行时配置 hooks </a>。</p>
<h4 id="Linux-运行时"><a href="#Linux-运行时" class="headerlink" title="Linux 运行时"></a>Linux 运行时</h4><p>默认情况下，运行时仅为应用程序打开 <code>stdin</code>，<code>stdout</code> 和<code>stderr</code> 的文件描述符。 运行时 <strong>也可以</strong> 给应用程序传入额外的文件描述，以支持如 <a target="_blank" rel="noopener" href="http://0pointer.de/blog/projects/socket-activated-containers.html">socket activation</a> 等功能。 有些文件描述符 <strong>可能</strong> 被重定向到了 <code>/dev/null</code>，即使他们是打开的。</p>
<p><strong>设备符号链接</strong></p>
<p>当(生命周期管理的步骤2)创建容器时，运行时须创建以下标准的符号链接：</p>
<table>
<thead>
<tr>
<th>Source</th>
<th>Destination</th>
</tr>
</thead>
<tbody><tr>
<td>&#x2F;proc&#x2F;self&#x2F;fd</td>
<td>&#x2F;dev&#x2F;fd</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;self&#x2F;fd&#x2F;0</td>
<td>&#x2F;dev&#x2F;stdin</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;self&#x2F;fd&#x2F;1</td>
<td>&#x2F;dev&#x2F;stdout</td>
</tr>
<tr>
<td>&#x2F;proc&#x2F;self&#x2F;fd&#x2F;2</td>
<td>&#x2F;dev&#x2F;stderr</td>
</tr>
</tbody></table>
<h2 id="四-配置-Linux-spec"><a href="#四-配置-Linux-spec" class="headerlink" title="四 配置( Linux spec )"></a>四 配置( Linux spec )</h2><p>容器的顶级目录 <strong>必须</strong> 包含一个名为 <code>config.json</code> 的配置文件。 本文档中定义的是典型的结构，但是还有 JSON 结构  <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/schema/config-schema.json">schema&#x2F;config-schema.json</a>  和 Go 版本的 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/specs-go/config.go"> specs-go&#x2F;config.go </a> 。</p>
<p>配置文件包含对容器执行标准操作所需的元数据。这包括运行的进程，要注入的环境变量，要使用的沙箱功能等。</p>
<p>下面是配置文件中定义的每个字段的详细描述。</p>
<h4 id="Specification-version"><a href="#Specification-version" class="headerlink" title="Specification version"></a>Specification version</h4><blockquote>
<ul>
<li><strong>ociVersion</strong> <em>string, REQUIRED</em> <strong>必须</strong> 是符合 <a target="_blank" rel="noopener" href="http://semver.org/spec/v2.0.0.html">SemVer v2.0.0</a> 格式的，并且指定 bundle 符合的开放容器运行时规范的版本。开放容器运行时规范遵守语义化版本并保证 major 版本的向前&#x2F;后兼容性。例如，如果一个配置兼容本规范的1.1版本，则它必须兼容所有支持1.1和后续版本的运行时），但是不兼容支持1.0的运行时。</li>
</ul>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;ociVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.1.0&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="Root-Configuration"><a href="#Root-Configuration" class="headerlink" title="Root Configuration"></a>Root Configuration</h4><p>root  配置容器的 rootfs 。</p>
<blockquote>
<ul>
<li><strong>path</strong> <em>string, REQUIRED</em> 指定容器的rootfs路径。 路径可以是绝对路径（以&#x2F;开头），也可以是相对于bundle的相对路径（不以&#x2F;开头）。 举个例子， bundle 的目录是 <em>&#x2F;to&#x2F;bundle</em>，rootfs 的目录是 <em>&#x2F;to&#x2F;bundle&#x2F;rootfs</em>，那么 path 的值可以写成  <em>&#x2F;to&#x2F;bundle&#x2F;rootfs</em>（绝对路径写法）或 <em>rootfs</em>（相对路径写法）。 path 内填写的目录 <strong>必须</strong> 存在。</li>
<li><strong>readonly</strong> <em>bool, OPTIONAL</em> 设置成 true 则容器内的 rootfs <strong>必须</strong> 是只读的，默认是 false 。</li>
</ul>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;root&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rootfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;readonly&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Mounts"><a href="#Mounts" class="headerlink" title="Mounts"></a>Mounts</h4><p> <strong>mounts</strong>  配置额外的 mount (在<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#root-configuration"> root </a>之上), 参数与<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man2/mount.2.html"> the Linux mount system call </a>类似。</p>
<blockquote>
<ul>
<li><strong>destination</strong> <em>string, REQUIRED</em> 挂载点的目标地址：容器内的路径。此指<strong>必须</strong>是绝对路径。</li>
<li><strong>type</strong>  <em>string, REQUIRED</em> 需要 mount 的文件系统类型。支持 <em>&#x2F;proc&#x2F;filesystems</em> 中列举的文件系统类型（如“minix”，“ext2”，“ext3”，“jfs”，“xfs”，“reiserfs”，”msdos“，”proc“，”nfs“, “iso9660”）。 Windows：ntfs。</li>
<li><strong>source</strong> <em>string, REQUIRED</em> 设备名，也可以是目录名或虚拟设备。</li>
<li><strong>options</strong> <em>list of strings, OPTIONAL</em> 文件系统 mount 参数。 Linux: [supported](<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man8/mount.8.html#FILESYSTEM-INDEPENDENT_MOUNT">http://man7.org/linux/man-pages/man8/mount.8.html#FILESYSTEM-INDEPENDENT_MOUNT</a> OPTIONS) [options](<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man8/mount.8.html#FILESYSTEM-SPECIFIC_MOUNT">http://man7.org/linux/man-pages/man8/mount.8.html#FILESYSTEM-SPECIFIC_MOUNT</a> OPTIONS) are listed in <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man8/mount.8.html">mount(8)</a>.</li>
</ul>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;mounts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/tmp&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tmpfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tmpfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span><span class="string">&quot;strictatime&quot;</span><span class="punctuation">,</span><span class="string">&quot;mode=755&quot;</span><span class="punctuation">,</span><span class="string">&quot;size=65536k&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/data&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bind&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/volumes/testing&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;rbind&quot;</span><span class="punctuation">,</span><span class="string">&quot;rw&quot;</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Process-configuration"><a href="#Process-configuration" class="headerlink" title="Process configuration"></a>Process configuration</h4><p>process 配置容器的进程。</p>
<blockquote>
<ul>
<li><strong>terminal</strong> <em>bool, optional</em>  指定是否需要连接该进程的终端，默认是 false。</li>
<li><strong>consoleSize</strong> <em>object, OPTIONAL</em> 指定终端的控制台窗口大小（如果连接了终端），包含以下属性：<ul>
<li><strong>height</strong> <em>uint, REQUIRED</em></li>
<li><strong>width</strong> <em>uint, REQUIRED</em></li>
</ul>
</li>
<li><strong>cwd</strong> <em>string, REQUIRED</em> 为可执行文件设置工作目录。此值 <strong>必须</strong> 是绝对路径。</li>
<li><strong>env</strong> <em>array of strings, OPTIONAL</em> 包含一组在进程执行前设置到其环境中的变量。数组里的元素指定为 “KEY&#x3D;value” 格式的字符串。左侧（KEY） <strong>必须</strong> 只包含字母，数字和下划线’_’，如<a target="_blank" rel="noopener" href="http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html">IEEE Std 1003.1-2001</a>.</li>
<li><strong>args</strong> <em>array of strings, REQUIRED</em> 可执行文件和一组标志（flags）。可执行文件是第一个数组的第一个元素，并且 <strong>必须</strong> 存在于给定的路径里。如果可执行文件的路径不是绝对路径，则通过 $PATH 查找可执行文件。</li>
</ul>
<p>对于基于Linux的系统，进程结构支持以下特定字段：</p>
<ul>
<li><strong>capabilities</strong> <em>array of strings, OPTIONAL</em> capabilities是一个数组，用于指定可以提供给容器内部进程的capabilities。有效值均是字符串，且定义在<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man7/capabilities.7.html">the man page</a>。</li>
<li><strong>rlimits</strong> <em>array of rlimits, OPTIONAL</em>  rlimits是一个数组，用于指定容器内的进程资源的限制。内核支持两种资源限制模式 soft 和 hard ,hard 表示强制的最高的上限。限制值可可通过一个非特权进程进行设置,有效值与资源类型字段定义在 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man2/setrlimit.2.html">the man page</a>.  </li>
<li><strong>apparmorProfile</strong> <em>string, OPTIONAL</em> 指定容器使用的 apparmor 配置文件名字。有关 Apparmor 的更多信息，请参考<a target="_blank" rel="noopener" href="https://wiki.ubuntu.com/AppArmor">Apparmor documentation</a>。</li>
<li><strong>selinuxLabel</strong> <em>string, OPTIONAL</em> 指定容器内进程运行时使用的 SELinux 标签。有关 SELinux 的更多信息，请参考<a target="_blank" rel="noopener" href="http://selinuxproject.org/page/Main_Page">Selinux documentation</a>。</li>
<li><strong>noNewPrivileges</strong> <em>bool, OPTIONAL</em> 将 noNewPrivileges 设置成 true 可以阻止容器内的进程申请额外的权限。 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt">The kernel doc</a>上有更多关于该功能如何使用prctl系统调用实现的信息。</li>
</ul>
</blockquote>
<h4 id="User"><a href="#User" class="headerlink" title="User"></a>User</h4><p>进程的用户是平台特定的结构，允许控制进程以哪个具体的用户运行。</p>
<blockquote>
<p>基于Linux和Solaris的系统，用户结构有以下字段：</p>
<ul>
<li><strong>uid</strong> (int, REQUIRED) 指定<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#container-namespace">container namespace</a>内的UID。</li>
<li><strong>gid</strong> (int, REQUIRED) 指定<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#container-namespace">container namespace</a>内的GID.</li>
<li><strong>additionalGids</strong> (array of ints, OPTIONAL) 指定添加给进程的额外的GID(在 <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#container-namespace">container namespace</a>内)。</li>
</ul>
<p><em>Note: 分别用于uid和gid的symbolic name，例如uname和game，留给更高级去导出（如解析&#x2F;etcpasswd，NSS等）。</em></p>
<p><em>Note: Solaris下，uid和gid指定容器内进程的uid和gid，并且不需要和宿主机一致。</em></p>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&quot;process&quot;: &#123;</span><br><span class="line">    &quot;terminal&quot;: true,</span><br><span class="line">    &quot;consoleSize&quot;: &#123;</span><br><span class="line">        &quot;height&quot;: 25,</span><br><span class="line">        &quot;width&quot;: 80</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;user&quot;: &#123;</span><br><span class="line">        &quot;uid&quot;: 1,</span><br><span class="line">        &quot;gid&quot;: 1,</span><br><span class="line">        &quot;additionalGids&quot;: [5, 6]</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;env&quot;: [</span><br><span class="line">        &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,</span><br><span class="line">        &quot;TERM=xterm&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;cwd&quot;: &quot;/root&quot;,</span><br><span class="line">    &quot;args&quot;: [</span><br><span class="line">        &quot;sh&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;apparmorProfile&quot;: &quot;acme_secure_profile&quot;,</span><br><span class="line">    &quot;selinuxLabel&quot;: &quot;system_u:system_r:svirt_lxc_net_t:s0:c124,c675&quot;,</span><br><span class="line">    &quot;noNewPrivileges&quot;: true,</span><br><span class="line">    &quot;capabilities&quot;: [</span><br><span class="line">        &quot;CAP_AUDIT_WRITE&quot;,</span><br><span class="line">        &quot;CAP_KILL&quot;,</span><br><span class="line">        &quot;CAP_NET_BIND_SERVICE&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;rlimits&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;type&quot;: &quot;RLIMIT_NOFILE&quot;,</span><br><span class="line">            &quot;hard&quot;: 1024,</span><br><span class="line">            &quot;soft&quot;: 1024</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Hostname"><a href="#Hostname" class="headerlink" title="Hostname"></a>Hostname</h4><blockquote>
<ul>
<li><strong>hostname</strong> <em>string, OPTIONAL</em> 配置容器中运行的进程能看到的容器主机名。Linux环境下，你只能在创建了新的<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man7/namespaces.7.html">UTS namespace</a>后才能设置此值。</li>
</ul>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;hostname&quot;: &quot;mrsdalloway&quot;</span><br></pre></td></tr></table></figure>

<h4 id="Platform"><a href="#Platform" class="headerlink" title="Platform"></a>Platform</h4><p>platform 指定了配置的目标平台。</p>
<blockquote>
<ul>
<li><strong>os</strong> <em>string, REQUIRED</em> 指定这个镜像对应的操作系统系列。 如果运行时不支持配置的 <strong>os</strong> <strong>必须</strong> 报错。 Bundles SHOULD use, and runtimes SHOULD understand, <strong>os</strong> entries listed in the Go Language document for <a target="_blank" rel="noopener" href="https://golang.org/doc/install/source#environment"><code>$GOOS</code></a>. 如果某个操作系统没有列在<code>$GOOS</code>的文档里，那么它 <strong>应该</strong> 被提交到这个规范里做标准化。</li>
<li><strong>arch</strong> <em>string, REQUIRED</em> 指定了镜像内二进制文件编译用到的指令集。 如果运行时不支持配置的 <strong>arch</strong> <strong>必须</strong> 报错。 Values for <strong>arch</strong> SHOULD use, and runtimes SHOULD understand, <strong>arch</strong> entries listed in the Go Language document for <a target="_blank" rel="noopener" href="https://golang.org/doc/install/source#environment"><code>$GOARCH</code></a>. 如果某个架构没有列在<code>$GOARCH</code>文档里，那么它 <strong>应该</strong> 被提交到这个规范里做标准化。</li>
</ul>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;platform&quot;: &#123;</span><br><span class="line">    &quot;os&quot;: &quot;linux&quot;,</span><br><span class="line">    &quot;arch&quot;: &quot;amd64&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Platform-specific-configuration"><a href="#Platform-specific-configuration" class="headerlink" title="Platform-specific configuration"></a>Platform-specific configuration</h4><p><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#platform"><strong>platform.os</strong></a> 用于检查进一步的平台相关的配置。</p>
<blockquote>
<ul>
<li><strong>linux</strong> (object, OPTIONAL) <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config-linux.md">Linux-specific configuration</a>. 仅当 <strong>platform.os</strong> 是<code>linux</code>时才推荐设置。</li>
<li><strong>solaris</strong> (object, OPTIONAL) <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config-solaris.md">Solaris-specific configuration</a>. 仅当 <strong>platform.os</strong> 是<code>solaris</code>时才推荐设置。</li>
<li><strong>windows</strong> (object, optional) <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config-windows.md">Windows-specific configuration</a>. 仅当 <strong>platform.os</strong> 是<code>windows</code>时才推荐设置。</li>
</ul>
</blockquote>
<p><em>示例：</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;platform&quot;: &#123;</span><br><span class="line">        &quot;os&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;arch&quot;: &quot;amd64&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;linux&quot;: &#123;</span><br><span class="line">        &quot;namespaces&quot;: [</span><br><span class="line">          &#123;</span><br><span class="line">            &quot;type&quot;: &quot;pid&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="Namespaces"><a href="#Namespaces" class="headerlink" title="Namespaces"></a>Namespaces</h4><p>命名空间将全局系统资源封装在抽象概念中，使得命名空间中的进程看起来具有自己的全局资源的独立实例。 更改全局资源，对属于命名空间成员中的其他进程可见，但对（非成员的）其他进程不可见。 更多信息请参考<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man7/namespaces.7.html">the man page</a>。</p>
<blockquote>
<p>命名空间被指定为 <em>namespaces</em> 字段中的数组。 设置命名空间可以指定以下参数：</p>
<ul>
<li><strong>type</strong> <em>string, REQUIRED</em> - 命名空间类型。支持下列命名空间类型：<ul>
<li><strong>pid</strong> 容器内的进程仅能看见同容器内的其他进程。</li>
<li><strong>network</strong> 容器有自己的网络栈。</li>
<li><strong>mount</strong> 容器有自己的挂载表。</li>
<li><strong>ipc</strong> 容器内的进程仅能通过系统级 IPC 与同一容器内的其他进程通信。</li>
<li><strong>uts</strong> 容器有自己的主机名和域名。</li>
<li><strong>user</strong> 容器能将主机中的用户和组 ID 重新映射到容器内的本地用户和组。</li>
<li><strong>cgroup</strong> 容器具有 cgroup 层次结构的独立视图。</li>
</ul>
</li>
<li><strong>path</strong> <em>string, OPTIONAL</em> - <a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#runtime-namespace">runtime mount namespace</a>中的命名空间文件路径。</li>
</ul>
<p>如果没有在 namespaces 数组中指定命名空间类型，则该容器必须继承该类型的<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#runtime-namespace">运行时命名空间</a>。 如果一个 namespaces 字段包含具有相同 type 的重复命名空间，那么运行时 <strong>必须</strong> 报错。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;namespaces&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pid&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/proc/1234/ns/pid&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;network&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/var/run/netns/neta&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mount&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ipc&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uts&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cgroup&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="User-namespace-mappings"><a href="#User-namespace-mappings" class="headerlink" title="User namespace mappings"></a>User namespace mappings</h4><blockquote>
<p><strong>uidMappings</strong> <em>array of objects, OPTIONAL</em> 描述从宿主机到容器的用户命名空间 uid 映射。</p>
<p> <strong>gidMappings</strong> <em>array of objects, OPTIONAL</em> 描述从宿主机到容器的用户命名空间 uid 映射。</p>
<p>每个条目都有以下的结构：</p>
<ul>
<li><strong>hostID</strong> <em>uint32, REQUIRED</em> - 将被映射到容器内宿主机上的启始 uid&#x2F;gid</li>
<li><strong>containerID</strong> <em>uint32, REQUIRED</em> - 在容器内的启始uid&#x2F;gid</li>
<li><strong>size</strong> <em>uint32, REQUIRED</em> -  被映射的id数量</li>
</ul>
<p>运行时 <strong>不应该</strong> 修改引用文件系统的所有权来实现映射。 Linux内核有5个映射的硬限制。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;uidMappings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;hostID&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;containerID&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gidMappings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;hostID&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;containerID&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Devices"><a href="#Devices" class="headerlink" title="Devices"></a>Devices</h4><blockquote>
<p><strong>devices</strong> <em>array of objects, OPTIONAL</em> 列出容器中 <strong>必须</strong> 可用的设备。</p>
<p>每个条目都有以下的结构：</p>
<ul>
<li><strong>type</strong> <em>string, REQUIRED</em> - 设备类型：<em>c ,  b ,  u</em>  或 <em>I</em>。 更多信息参考<a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man1/mknod.1.html">mknod(1)</a>。</li>
<li><strong>path</strong> <em>string, REQUIRED</em> - 容器内设备的完整路径。</li>
<li><strong>major, minor</strong> *int64, REQUIRED  - 设备的<a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/devices.txt">major, minor numbers</a>。</li>
<li><strong>fileMode</strong> <em>uint32, OPTIONAL</em>- 设备的文件模式。 你可以<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config-linux.md#device-whitelist">通过cgroups</a>控制设备的访问。</li>
<li><strong>uid</strong> <em>uint32, OPTIONAL</em>- 设备所有者的ID。</li>
<li><strong>gid</strong> <em>uint32, OPTIONAL</em> - 设备归属组的ID。</li>
</ul>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;devices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/fuse&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">229</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;fileMode&quot;</span><span class="punctuation">:</span> <span class="number">438</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;uid&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;gid&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/sda&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;fileMode&quot;</span><span class="punctuation">:</span> <span class="number">432</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;uid&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;gid&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><strong>默认设备列表：</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/null.4.html">&#x2F;dev&#x2F;null</a></li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/zero.4.html">&#x2F;dev&#x2F;zero</a></li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/full.4.html">&#x2F;dev&#x2F;full</a></li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/random.4.html">&#x2F;dev&#x2F;random</a></li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/random.4.html">&#x2F;dev&#x2F;urandom</a></li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/tty.4.html">&#x2F;dev&#x2F;tty</a></li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/console.4.html">&#x2F;dev&#x2F;console</a> </li>
<li><a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man4/pts.4.html">&#x2F;dev&#x2F;ptmx</a></li>
</ul>
<h4 id="Control-groups"><a href="#Control-groups" class="headerlink" title="Control groups"></a>Control groups</h4><p>称之为cgroups, 被用于容器对资源使用的限制和处理设备的访问限制。cgroups提供通过相应的控制器去限制容器的 cpu 、内存 、IO 、pid 、网络等资源使用。详细信息参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/cgroups.txt">kernel cgroups documentation</a>.</p>
<p>通过 <em>cgroupsPath</em> 项可指定 cgroups 路径. 通过 <em>resource</em> 项配置容器的资源限制。 </p>
<h6 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;cgroupsPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/myRuntime/myContainer&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;resources&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;memory&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">         <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">100000</span><span class="punctuation">,</span></span><br><span class="line">         <span class="attr">&quot;reservation&quot;</span><span class="punctuation">:</span> <span class="number">200000</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;devices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">         <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rwm&quot;</span></span><br><span class="line">         <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Device-whitelist"><a href="#Device-whitelist" class="headerlink" title="Device whitelist"></a>Device whitelist</h4><p><strong>devices</strong> <em>array of objects, OPTIONAL</em> 配置设备的白名单。</p>
<p>列表内的每项包含以下结构：</p>
<ul>
<li><strong>allow</strong> <em>boolean, REQUIRED</em> - 实体项是被否允许或拒绝</li>
<li><strong>type</strong> <em>string, OPTIONAL</em> - 设备类型: <code>a</code> (all), <code>c</code> (字符), 或  <code>b</code> (块). <code>null</code> 或未设代表 “all”</li>
<li><strong>major, minor</strong> <em>int64, OPTIONAL</em> - <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/devices.txt">major, minor numbers</a> 设备主、次版本 <code>null</code> 或未设代表 “all” <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/devices.txt"><code>*</code> in the filesystem API</a>.</li>
<li><strong>access</strong> <em>string, OPTIONAL</em> - 设备cgroup权限.  由<code>r</code> (读), <code>w</code> (写), 和 <code>m</code>(mknod)组成.</li>
</ul>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;devices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rwm&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">229</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rw&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;r&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Disable-out-of-memory-killer"><a href="#Disable-out-of-memory-killer" class="headerlink" title="Disable out-of-memory killer"></a>Disable out-of-memory killer</h4><p><code>disableOOMKiller</code> 设置布尔值 true 或  false为 cgroup 开启或关闭OOM killer机制.详细可参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/memory.txt">the memory cgroup man page</a>。</p>
<ul>
<li><strong>disableOOMKiller</strong> <em>(bool, OPTIONAL)</em> - 开启或关闭 OOM killer</li>
</ul>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;disableOOMKiller&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br></pre></td></tr></table></figure>

<h4 id="Set-oom-score-adj"><a href="#Set-oom-score-adj" class="headerlink" title="Set oom_score_adj"></a>Set oom_score_adj</h4><p><code>oomScoreAdj</code>设置有关当内存压力情况下内核将如何处理进程的启发式方法。详细可参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/filesystems/proc.txt">the proc filesystem documentation section 3.1</a>. This is a kernel&#x2F;system level setting这是一个内核&#x2F;系统级设置, 其中”disableoomkiller”作用于内存cgroup ,详细可参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/memory.txt">the memory cgroup documentation section 10. OOM Contol</a>.</p>
<ul>
<li><strong>oomScoreAdj</strong> <em>int, OPTIONAL</em> - 调节oom-killer的分值</li>
</ul>
<h6 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;oomScoreAdj&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>

<h4 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h4><p><strong>memory</strong> <em>object, OPTIONAL</em> 表示用 cgroup 子系统 memory 对容器的内存使用进行限制。详细信息参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/memory.txt">the memory cgroup man page</a>.</p>
<p>可指定的参数配置：</p>
<ul>
<li><strong>limit</strong> <em>uint64, OPTIONAL</em> - 设置内存使用限制(bytes)</li>
<li><strong>reservation</strong> <em>uint64, OPTIONAL</em> - 设置内存使用软限制(bytes)</li>
<li><strong>swap</strong> <em>uint64, OPTIONAL</em> - 设置内存+swap使用限制</li>
<li><strong>kernel</strong> <em>uint64, OPTIONAL</em> - 设置内核内存硬限制</li>
<li><strong>kernelTCP</strong> <em>uint64, OPTIONAL</em> - 设置内核TCP缓存内存硬限制</li>
<li><strong>swappiness</strong> <em>uint64, OPTIONAL</em> - 设置内存交换限制</li>
</ul>
<h6 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;memory&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">536870912</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;reservation&quot;</span><span class="punctuation">:</span> <span class="number">536870912</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;swap&quot;</span><span class="punctuation">:</span> <span class="number">536870912</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;kernel&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;kernelTCP&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;swappiness&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h4><p><strong>cpu</strong> <em>object, OPTIONAL</em> cgroup 子系统 <code>cpu</code> and <code>cpusets</code>. 详细信息参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/cpusets.txt">the cpusets cgroup man page</a>.</p>
<p>可配置的参数：</p>
<ul>
<li><strong>shares</strong> <em>uint64, OPTIONAL</em> - 指定一个在cgroup内任务的可使用的CPU时间相对比重。</li>
<li><strong>quota</strong> <em>uint64, OPTIONAL</em> - 指定在一个周期(由下面的period参数指定)内cgroup内的所有任务运行的总时间值(microseconds)</li>
<li><strong>period</strong> <em>uint64, OPTIONAL</em> - 仅适用完全公平调度，指定一个CGroup对CPU资源的访问应该多久重新分配一次(microseconds)</li>
<li><strong>realtimeRuntime</strong> <em>uint64, OPTIONAL</em> - 指定任务占用CPU资源最长连续周期(microseconds)</li>
<li><strong>realtimePeriod</strong> <em>uint64, OPTIONAL</em> - 如同period，但仅应用于实时调度器</li>
<li><strong>cpus</strong> <em>string, OPTIONAL</em> -  容器将被运行的CPU列表</li>
<li><strong>mems</strong> <em>string, OPTIONAL</em> - 容器将被运行的内存节点列表</li>
</ul>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;cpu&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;shares&quot;</span><span class="punctuation">:</span> <span class="number">1024</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;quota&quot;</span><span class="punctuation">:</span> <span class="number">1000000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;period&quot;</span><span class="punctuation">:</span> <span class="number">500000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;realtimeRuntime&quot;</span><span class="punctuation">:</span> <span class="number">950000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;realtimePeriod&quot;</span><span class="punctuation">:</span> <span class="number">1000000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cpus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mems&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0-7&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Block-IO-Controller"><a href="#Block-IO-Controller" class="headerlink" title="Block IO Controller"></a>Block IO Controller</h4><p><strong>blockIO</strong> <em>object, OPTIONAL</em> cgroup  <code>blkio</code>子系统，实现对块设备IO控制器。详细信息可参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/blkio-controller.txt">the kernel cgroups documentation about blkio</a>.</p>
<p>可指定配置参数：</p>
<ul>
<li><strong>blkioWeight</strong> <em>uint16, OPTIONAL</em> - 指定每个 cgroup 权限. 取值区间 10 ~ 1000.</li>
<li><strong>blkioLeafWeight</strong> <em>uint16, OPTIONAL</em> - 相当于 <em>blkioweight</em> ,当竞争产生时的权重.取值区间 10 ~ 1000</li>
<li><strong>blkioWeightDevice</strong> <em>array, OPTIONAL</em> - 指定blkio带宽速率限制的设备列表. 每个设备可指定的参数:<ul>
<li><strong>major, minor</strong> <em>int64, REQUIRED</em> - 设备的主、次版本号</li>
<li><strong>weight</strong> <em>uint16, OPTIONAL</em> - 设备的blkio带宽速率，取值区间 10~1000</li>
<li><strong>leafWeight</strong> <em>uint16, OPTIONAL</em> - 当与 cgroup 的子 cgoup 产生竞争时设备的带宽速率 cgroups, ,值区间10~1000。仅作用于完全公平调度算法</li>
</ul>
</li>
<li><strong>blkioThrottleReadBpsDevice</strong>, <strong>blkioThrottleWriteBpsDevice</strong>, <strong>blkioThrottleReadIOPSDevice</strong>, <strong>blkioThrottleWriteIOPSDevice</strong> <em>array, OPTIONAL</em> - IO率限制设备列表<ul>
<li><strong>major, minor</strong> <em>int64, REQUIRED</em> - 设备的主、次版本号</li>
<li><strong>rate</strong> <em>uint64, REQUIRED</em> - 设备的io率限制</li>
</ul>
</li>
</ul>
<h6 id="Example-3"><a href="#Example-3" class="headerlink" title="Example"></a>Example</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;blockIO&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;blkioWeight&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;blkioLeafWeight&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;blkioWeightDevice&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;weight&quot;</span><span class="punctuation">:</span> <span class="number">500</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;leafWeight&quot;</span><span class="punctuation">:</span> <span class="number">300</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;weight&quot;</span><span class="punctuation">:</span> <span class="number">500</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;blkioThrottleReadBpsDevice&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;rate&quot;</span><span class="punctuation">:</span> <span class="number">600</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;blkioThrottleWriteIOPSDevice&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;rate&quot;</span><span class="punctuation">:</span> <span class="number">300</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Huge-page-limits"><a href="#Huge-page-limits" class="headerlink" title="Huge page limits"></a>Huge page limits</h4><p><strong>hugepageLimits</strong> <em>array of objects, OPTIONAL</em> 表示hugetlb控制器允许限制每个控制组的HugeTLB使用和控制器限制错误页, 更多信息参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/hugetlb.txt">kernel cgroups documentation about HugeTLB</a>。</p>
<p>每项有以下结构配置：</p>
<ul>
<li><strong>pageSize</strong> <em>string, REQUIRED</em> - hugepage size 大页的大小</li>
<li><strong>limit</strong> <em>uint64, REQUIRED</em> - HugeTLB 使用限制</li>
</ul>
<h6 id="Example-4"><a href="#Example-4" class="headerlink" title="Example"></a>Example</h6><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;hugepageLimits&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2MB&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">9223372036854771712</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h4><p><strong>network</strong> <em>object, OPTIONAL</em> 代表 cgroup 的 <em>net_cls</em>  和  <em>net_prio</em> 子系统。 更多信息，参考<a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/net_cls.txt">the net_cls cgroup man page</a> 和 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/net_prio.txt">the net_prio cgroup man page</a>。</p>
<p>可以指定以下参数来设置控制器：</p>
<ul>
<li><p><strong>classID</strong> <em>uint32, OPTIONAL</em> - 网络类标识，cgroup网络包被与之关联标记</p>
</li>
<li><p><strong>priorities</strong> <em>array, OPTIONAL</em> - 指定分配给来自组中进程并在各接口上出流量优先级的对象列表。  </p>
<p>每个优先级可指定的参数:</p>
<ul>
<li><strong>name</strong> <em>string, REQUIRED</em> - 网卡名字</li>
<li><strong>priority</strong> <em>uint32, REQUIRED</em> - 应用在此网卡的优先级</li>
</ul>
</li>
</ul>
<p><em>示例：</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;classID&quot;</span><span class="punctuation">:</span> <span class="number">1048577</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;priorities&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth0&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;priority&quot;</span><span class="punctuation">:</span> <span class="number">500</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;priority&quot;</span><span class="punctuation">:</span> <span class="number">1000</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">   <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="PIDs"><a href="#PIDs" class="headerlink" title="PIDs"></a>PIDs</h5><p><strong>pids</strong> (object, OPTIONAL) 代表cgroup的<code>pids</code>子系统。 更多信息，参考<a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/cgroup-v1/pids.txt">the pids cgroup man page</a>。</p>
<p>可以指定以下参数来设置控制器：</p>
<ul>
<li><strong>limit</strong> <em>(int64, REQUIRED)</em> - 指定cgroup下最大任务数量。</li>
</ul>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;pids&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">32771</span></span><br><span class="line">   <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Sysctl"><a href="#Sysctl" class="headerlink" title="Sysctl"></a>Sysctl</h4><blockquote>
<p><strong>sysctl</strong> <em>object, OPTIONAL</em> 允许为容器在运行时对内核参数进行设置，更多信息可以参考 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man8/sysctl.8.html">sysctl(8)</a> </p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;sysctl&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">       <span class="attr">&quot;net.ipv4.ip_forward&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;net.core.somaxconn&quot;</span><span class="punctuation">:</span> <span class="string">&quot;256&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Seccomp"><a href="#Seccomp" class="headerlink" title="Seccomp"></a>Seccomp</h4><p>Seccomp 在 linux 内核层为应用提供沙盒机制。seccomp配置允许配置对匹配的syscall执行的操作，并且还允许对作为参数传递给syscalls的值进行匹配，更多信息可以参考 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/prctl/seccomp_filter.txt">Seccomp</a> 内核文档。</p>
<blockquote>
<p><strong>seccomp</strong>  <em>object, OPTIONAL</em></p>
<p>可指定配置seccomp的参数如下：</p>
<ul>
<li><strong>defaultAction</strong> <em>string, REQUIRED</em> - seccomp执行的默认动作，可配置的值与一致 <em>syscalls[].action</em> </li>
<li><strong>architectures</strong> <em>array of strings, OPTIONAL</em> - 系统调用所使用的架构</li>
<li><strong>syscalls</strong> <em>array of objects, OPTIONAL</em> -在seccomp内匹配syscall</li>
</ul>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;seccomp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;defaultAction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SCMP_ACT_ALLOW&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;architectures&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">         <span class="string">&quot;SCMP_ARCH_X86&quot;</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;syscalls&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">         <span class="punctuation">&#123;</span></span><br><span class="line">             <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;getcwd&quot;</span><span class="punctuation">,</span></span><br><span class="line">             <span class="attr">&quot;action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SCMP_ACT_ERRNO&quot;</span></span><br><span class="line">         <span class="punctuation">&#125;</span></span><br><span class="line">     <span class="punctuation">]</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="Rootfs-Mount-Propagation"><a href="#Rootfs-Mount-Propagation" class="headerlink" title="Rootfs Mount Propagation"></a>Rootfs Mount Propagation</h4><blockquote>
<p><strong>rootfsPropagation</strong> <em>string, OPTIONAL</em> 设置 rootfs 的挂载传播。 取值是 <em>slave、private</em> 或 <em>shared</em>。 有关于安装传播的更多信息，参考<a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt">The kernel doc</a>。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;rootfsPropagation&quot;</span><span class="punctuation">:</span> <span class="string">&quot;slave&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="Masked-Paths"><a href="#Masked-Paths" class="headerlink" title="Masked Paths"></a>Masked Paths</h4><blockquote>
<p><strong>maskedPaths</strong> (array of strings, OPTIONAL) 在容器内掩藏提供的路径，使它们无法读取。 这些路径在<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#container_namespace">容器命名空间</a> <strong>必须</strong>是绝对路径。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;maskedPaths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;/proc/kcore&quot;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Readonly-Paths"><a href="#Readonly-Paths" class="headerlink" title="Readonly Paths"></a>Readonly Paths</h4><blockquote>
<p><strong>readonlyPaths</strong> <em>array of strings, OPTIONAL</em> 在容器内设置提供的路径为只读，这些路径在<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#container_namespace">容器命名空间</a> <strong>须</strong> 是绝对路径。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;readonlyPaths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;/proc/sys&quot;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h4 id="Mount-Label"><a href="#Mount-Label" class="headerlink" title="Mount Label"></a>Mount Label</h4><blockquote>
<p><strong>mountLabel</strong> <em>string, OPTIONAL</em> 为容器挂载的设置 Selinux上下文。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;mountLabel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system_u:object_r:svirt_sandbox_file_t:s0:c715,c811&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><blockquote>
<p> <strong>hooks</strong> <em>object, OPTIONAL</em> 用来配置容器生命周期事件的回调。 Liftcycle hooks允许对容器运行时的许多（逻辑）点自定义事件。 目前有<em>Prestart，Poststart</em> 和 <em>Poststop</em>。</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#prestart">Prestart</a> 容器进程运行前被调用的一组钩子。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#poststart">Poststart</a> 容器进程运行后立即被调用的一组钩子。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/config.md#poststop">Poststop</a> 容器进程退出后被调用的一组钩子。</p>
<p>钩子允许在容器的各种生命周期事件之前&#x2F;之后运行代码。钩子 <strong>必须</strong> 按照列表顺序（声明顺序）被调用。容器的状态会通过stdin传入到钩子内，这样钩子（程序）就可以拿到它们工作需要的信息。</p>
<p>钩子的路径是绝对路径，并且可以在<a target="_blank" rel="noopener" href="https://github.com/BrickXu/oci-runtime-spec/blob/master/glossary.md#runtime-namespace">runtime namespace</a>中执行。</p>
</li>
</ul>
</blockquote>
<p><strong>Prestart</strong></p>
<p>pre-start钩子在容器进程产生后，用户提供的命令执行之前被调用。Linux下，他们在容器的namespaces创建以后被调用，因此提供了自定义容器的机会。举个例子， 在此钩子里可以配置network namespace。</p>
<p>如果钩子返回了非零的退出码（参考shell中的$?），则一个包含了退出码和stderr的错误被返回给调用者，同时容器被回收。</p>
<p><strong>Poststart</strong></p>
<p>post-start钩子在用户进程运行启动后被调用。举个例子，这个钩子可以通知用户真正产生的进程（的PID或其他balabala）。</p>
<p>如果钩子返回了非零的退出码（参考shell中的$?），记录下错误并继续执行剩下的钩子。</p>
<p><strong>Poststop</strong></p>
<p>post-stop钩子在容器进程停止后被调用。可以在此钩子中执行清理或调试工作。</p>
<p>如果钩子返回了非零的退出码（参考shell中的$?），记录下错误并继续执行剩下的钩子。</p>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;hooks&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;prestart&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/fix-mounts&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;fix-mounts&quot;</span><span class="punctuation">,</span> <span class="string">&quot;arg1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;arg2&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span>  <span class="punctuation">[</span> <span class="string">&quot;key1=value1&quot;</span><span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/setup-network&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;poststart&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/notify-start&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;timeout&quot;</span><span class="punctuation">:</span> <span class="number">5</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;poststop&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/sbin/cleanup.sh&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;cleanup.sh&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-f&quot;</span><span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Annotations"><a href="#Annotations" class="headerlink" title="Annotations"></a>Annotations</h3><blockquote>
<p> <strong>annotations</strong> <em>object, OPTIONAL</em> 包含了容器的任意元数据。 这些元数据信息 <strong>可能</strong> 是结构化的或非结构化的。 注解 <strong>必须</strong> 是键值对映射，而且键值 <strong>必须</strong> 是字符串。 值 <strong>必须</strong> 存在，但 <strong>可能</strong> 是空字符串。 键在映射中 <strong>必须</strong> 是唯一的，最好的办法就是使用命名空间。 键 <strong>应该</strong> 以反向域名的方式命名 —— 比如 <em>com.example.myKey</em> 。<em>org.opencontainers</em> 命名空间下的键是保留关键字，并且 <strong>一定不能</strong> 被后续的规范使用。 如果没有注解，此值 <strong>可能</strong> 不存在或者是空映射。 正在读取&#x2F;处理配置文件的实现 <strong>一定不能</strong> 在遇到一个未知属性时报错。</p>
</blockquote>
<p><em>示例</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;annotations&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;com.example.gpu-cores&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Extensibility"><a href="#Extensibility" class="headerlink" title="Extensibility"></a>Extensibility</h3><p>正在读取&#x2F;处理配置文件的（runtime）实现 <strong>一定不能</strong> 在遇到一个未知属性时报错，而是 <strong>必须</strong> 忽略这些未知的属性。</p>
<p><em>config.json 完整的配置示例供参考：</em></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ociVersion&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.5.0-dev&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;platform&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;os&quot;</span><span class="punctuation">:</span> <span class="string">&quot;linux&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;arch&quot;</span><span class="punctuation">:</span> <span class="string">&quot;amd64&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;process&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;terminal&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;uid&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;gid&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;additionalGids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">                <span class="number">6</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;sh&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;TERM=xterm&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;capabilities&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;CAP_AUDIT_WRITE&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;CAP_KILL&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;CAP_NET_BIND_SERVICE&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;rlimits&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RLIMIT_CORE&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;hard&quot;</span><span class="punctuation">:</span> <span class="number">1024</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;soft&quot;</span><span class="punctuation">:</span> <span class="number">1024</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RLIMIT_NOFILE&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;hard&quot;</span><span class="punctuation">:</span> <span class="number">1024</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;soft&quot;</span><span class="punctuation">:</span> <span class="number">1024</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;apparmorProfile&quot;</span><span class="punctuation">:</span> <span class="string">&quot;acme_secure_profile&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selinuxLabel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system_u:system_r:svirt_lxc_net_t:s0:c124,c675&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;noNewPrivileges&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;root&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rootfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;readonly&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;hostname&quot;</span><span class="punctuation">:</span> <span class="string">&quot;slartibartfast&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mounts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/proc&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;proc&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;proc&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tmpfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tmpfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;strictatime&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;mode=755&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;size=65536k&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/pts&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;devpts&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;devpts&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;noexec&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;newinstance&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;ptmxmode=0666&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;mode=0620&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;gid=5&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/shm&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tmpfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shm&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;noexec&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;nodev&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;mode=1777&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;size=65536k&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/mqueue&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mqueue&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mqueue&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;noexec&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;nodev&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/sys&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sysfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sysfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;noexec&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;nodev&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/sys/fs/cgroup&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cgroup&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cgroup&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;nosuid&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;noexec&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;nodev&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;relatime&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;ro&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;hooks&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;prestart&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/fix-mounts&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;fix-mounts&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="string">&quot;arg1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="string">&quot;arg2&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;env&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;key1=value1&quot;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/setup-network&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;poststart&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/notify-start&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;timeout&quot;</span><span class="punctuation">:</span> <span class="number">5</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;poststop&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/sbin/cleanup.sh&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;cleanup.sh&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="string">&quot;-f&quot;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;linux&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;devices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/fuse&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">229</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;fileMode&quot;</span><span class="punctuation">:</span> <span class="number">438</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;uid&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;gid&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/sda&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;fileMode&quot;</span><span class="punctuation">:</span> <span class="number">432</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;uid&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;gid&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;uidMappings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;hostID&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;containerID&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="number">32000</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gidMappings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;hostID&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;containerID&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="number">32000</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;sysctl&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;net.ipv4.ip_forward&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;net.core.somaxconn&quot;</span><span class="punctuation">:</span> <span class="string">&quot;256&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cgroupsPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/myRuntime/myContainer&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;resources&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;classID&quot;</span><span class="punctuation">:</span> <span class="number">1048577</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;priorities&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth0&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;priority&quot;</span><span class="punctuation">:</span> <span class="number">500</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;priority&quot;</span><span class="punctuation">:</span> <span class="number">1000</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;pids&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">32771</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;hugepageLimits&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2MB&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">9223372036854772000</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;oomScoreAdj&quot;</span><span class="punctuation">:</span> <span class="number">100</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;memory&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;limit&quot;</span><span class="punctuation">:</span> <span class="number">536870912</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;reservation&quot;</span><span class="punctuation">:</span> <span class="number">536870912</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;swap&quot;</span><span class="punctuation">:</span> <span class="number">536870912</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;kernel&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;kernelTCP&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;swappiness&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cpu&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;shares&quot;</span><span class="punctuation">:</span> <span class="number">1024</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;quota&quot;</span><span class="punctuation">:</span> <span class="number">1000000</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;period&quot;</span><span class="punctuation">:</span> <span class="number">500000</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;realtimeRuntime&quot;</span><span class="punctuation">:</span> <span class="number">950000</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;realtimePeriod&quot;</span><span class="punctuation">:</span> <span class="number">1000000</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;cpus&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2-3&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;mems&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0-7&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;disableOOMKiller&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;devices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rwm&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">229</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rw&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;allow&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;access&quot;</span><span class="punctuation">:</span> <span class="string">&quot;r&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;blockIO&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;blkioWeight&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;blkioLeafWeight&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;blkioWeightDevice&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;weight&quot;</span><span class="punctuation">:</span> <span class="number">500</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;leafWeight&quot;</span><span class="punctuation">:</span> <span class="number">300</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;weight&quot;</span><span class="punctuation">:</span> <span class="number">500</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;blkioThrottleReadBpsDevice&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;rate&quot;</span><span class="punctuation">:</span> <span class="number">600</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;blkioThrottleWriteIOPSDevice&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;rate&quot;</span><span class="punctuation">:</span> <span class="number">300</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;rootfsPropagation&quot;</span><span class="punctuation">:</span> <span class="string">&quot;slave&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;seccomp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;defaultAction&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SCMP_ACT_ALLOW&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;architectures&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;SCMP_ARCH_X86&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;syscalls&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;getcwd&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SCMP_ACT_ERRNO&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;namespaces&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pid&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;network&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ipc&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;uts&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mount&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;user&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cgroup&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maskedPaths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;/proc/kcore&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/latency_stats&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/timer_stats&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/sched_debug&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;readonlyPaths&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;/proc/asound&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/bus&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/fs&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/irq&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/sys&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;/proc/sysrq-trigger&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mountLabel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system_u:object_r:svirt_sandbox_file_t:s0:c715,c811&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;annotations&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;com.example.key1&quot;</span><span class="punctuation">:</span> <span class="string">&quot;value1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;com.example.key2&quot;</span><span class="punctuation">:</span> <span class="string">&quot;value2&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<p>~~ <strong>本文 END</strong> ~~</p>


<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/2023/01/16/OCI_image_spec/">OCI 镜像格式规范</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/2023/01/16/RunC_NameSpace/">RunC 源码通读指南之 NameSpace</a></div></section></div>






  <div class='related-wrap md-text reveal' id="comments">
    <section class='header cmt-title cap theme'>
      快来参与讨论吧
    </section>
    <section class='body cmt-body artalk'>
      

<div id="artalk_container"><svg class="loading" style="vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>
    </section>
  </div>



      
<footer class="page-footer reveal fs12"><hr><div class="text"><p>个人技术分享 |  经验总结 |  技术实践  |  心情<br>XiaoYang   <a href="mailto:&#x73;&#117;&#112;&#101;&#114;&#x73;&#112;&#106;&#106;&#x40;&#49;&#54;&#51;&#46;&#x63;&#111;&#109;">&#x73;&#117;&#112;&#101;&#114;&#x73;&#112;&#106;&#106;&#x40;&#49;&#54;&#51;&#46;&#x63;&#111;&#109;</a>          </p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.18.5';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.18.5';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"codeblock":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.css","js":"https://unpkg.com/swiper@8.4.5/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->

  <script>
  function load_artalk() {
    if (!document.querySelectorAll("#artalk_container")[0]) return;
    stellar.loadCSS('https://unpkg.com/artalk@2.4.3/dist/Artalk.css');
    stellar.loadScript('https://unpkg.com/artalk@2.4.3/dist/Artalk.js', {defer: true}).then(function () {
      const el = document.getElementById("artalk_container");
      var path = el.getAttribute('comment_id');
      if (!path) {
        path = decodeURI(window.location.pathname);
      }
      var artalk = new Artalk({
        el: '#artalk_container',
        pageKey: path,
        pageTitle: 'OCI Runtime spec 运行时规范',
        server: '',
        placeholder: '',
        site: '知识库',
        darkMode: 'auto'
        })
      });
  }
  window.addEventListener('DOMContentLoaded', (event) => {
    load_artalk();
  });
</script>



<!-- inject -->


  </div>
</body>
</html>
